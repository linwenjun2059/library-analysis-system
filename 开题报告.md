# 毕业设计（论文）开题报告

## 题目：基于Hive+Spark的高校图书馆借阅行为分析系统的设计与实现

---

## 一、毕业设计（论文）选题的目的和意义

### （一）题目名称

基于Hive+Spark的高校图书馆借阅行为分析系统的设计与实现

### （二）选题背景和发展情况分析

#### 1. 研究背景

随着高校信息化建设的不断深入，图书馆作为高校重要的学术资源中心，积累了海量的借阅数据。这些数据蕴含着丰富的读者行为模式、阅读偏好和图书流通规律等有价值的信息。然而，传统的图书馆管理系统主要侧重于借还书业务的处理，缺乏对借阅数据的深度挖掘和分析能力，难以为图书馆的精细化管理和个性化服务提供有效的数据支撑。

在大数据时代背景下，如何利用大数据技术对图书馆借阅数据进行有效的存储、处理和分析，挖掘数据背后的价值，已成为高校图书馆数字化转型的重要课题。Apache Hadoop生态系统中的Hive和Spark作为成熟的大数据处理框架，为海量数据的存储和分析提供了强有力的技术支撑。

#### 2. 国内外发展现状

**国外研究现状：**
国外高校图书馆在数据分析领域起步较早，已形成较为成熟的应用体系。美国图书馆协会（ALA）推动的"图书馆分析"项目，利用大数据技术分析读者行为，优化馆藏资源配置。欧洲多所高校图书馆采用机器学习算法实现个性化推荐服务，显著提升了读者满意度。

**国内研究现状：**
国内高校图书馆的数据分析应用近年来发展迅速。清华大学、北京大学等高校图书馆已开展基于大数据的读者行为分析研究。然而，大多数高校图书馆仍停留在简单的统计报表阶段，缺乏系统化的数据仓库建设和深度数据挖掘能力。

**技术发展趋势：**
- 数据仓库分层架构（ODS→DWD→DWS→ADS）成为数据治理的标准范式
- Spark MLlib为图书推荐和用户画像提供了成熟的机器学习算法支持
- 前后端分离架构和可视化技术使数据分析结果更易于理解和应用

### （三）前人在本选题领域中的工作成果简述

1. **数据仓库建设方面：** Kimball提出的维度建模理论为图书馆数据仓库设计提供了理论基础，国内学者在此基础上提出了适用于图书馆场景的星型模型设计方案。

2. **借阅行为分析方面：** 已有研究利用统计分析方法对借阅时间分布、热门图书排行、院系借阅偏好等进行分析，但多采用传统数据库技术，难以处理大规模数据。

3. **推荐系统方面：** 协同过滤算法（如ALS）和基于内容的推荐算法在图书推荐领域得到广泛应用，但单一算法存在冷启动、数据稀疏等问题，混合推荐策略成为研究热点。

4. **数据挖掘方面：** FPGrowth关联规则挖掘算法用于发现图书之间的关联关系，K-means聚类算法用于读者分群，但在高校图书馆场景的应用研究相对较少。

---

## 二、设计或论文主要内容和重点，预期达到的目标及拟解决的主要问题和解决问题的思路

### （一）主要内容

本系统基于Hive+Spark大数据技术栈，构建一个完整的高校图书馆借阅行为分析系统，主要包括以下模块：

#### 1. 数据仓库建设模块
采用分层数据仓库架构，实现数据的规范化存储和管理：
- **ODS层（原始数据层）：** 存储原始借阅CSV数据，保持数据原貌
- **DWD层（明细数据层）：** 数据清洗与转换，构建用户维度表、图书维度表、借阅明细事实表
- **DWS层（汇总数据层）：** 按用户、图书、院系、主题、日期等维度进行数据汇总
- **ADS层（应用数据层）：** 面向业务应用的数据集市，支持各类分析场景

#### 2. 统计分析模块
- 热门图书排行分析（TOP100）
- 活跃用户排行分析（TOP100）
- 院系借阅偏好分析
- 借阅趋势分析（时间序列）
- 时间分布分析（按小时/星期/月份）
- 逾期行为分析

#### 3. 智能推荐模块
采用混合推荐算法，融合三种推荐策略：
- **ALS协同过滤推荐：** 基于用户借阅历史的相似度推荐（权重50%）
- **内容过滤推荐：** 基于图书主题和作者的相似度推荐（权重30%）
- **热门推荐：** 基于借阅热度的推荐（权重20%）

#### 4. 数据挖掘模块
- **FPGrowth关联规则挖掘：** 发现图书之间的隐性关联（如"借了A也借B"）
- **K-means用户聚类：** 识别不同阅读偏好群体（如专业深耕型、博览群书型等）

#### 5. 预测分析模块
- **逾期风险预测：** 基于随机森林算法预测用户逾期概率
- **借阅趋势预测：** 基于时间序列回归预测未来借阅量
- **图书热度预测：** 预测图书未来的借阅热度

#### 6. 多角色权限管理
- **高级管理员：** 运营分析、数据挖掘、预测分析、系统监控
- **图书管理员：** 业务管理、统计分析、逾期管理
- **普通用户：** 个人数据、图书推荐、阅读画像

### （二）重点内容

1. **分层数据仓库的设计与实现：** 合理设计ODS→DWD→DWS→ADS四层架构，确保数据质量和查询效率

2. **混合推荐算法的设计与优化：** 解决单一推荐算法的局限性，提高推荐准确率和多样性

3. **机器学习模型的应用：** 将FPGrowth、K-means、随机森林等算法应用于图书馆场景

### （三）预期目标

1. 构建完整的图书馆借阅数据仓库，实现数据的规范化存储和高效查询
2. 提供多维度的统计分析功能，支持图书馆运营决策
3. 实现个性化图书推荐，提升读者借阅体验
4. 通过数据挖掘发现借阅行为规律，为馆藏优化提供依据
5. 建立预测模型，实现逾期预警和趋势预测

### （四）拟解决的主要问题及解决思路

| 问题 | 解决思路 |
|------|----------|
| 海量借阅数据的存储和处理 | 采用HDFS分布式存储 + Hive数据仓库 + Spark计算引擎 |
| 数据质量问题（缺失值、异常值） | 在DWD层进行数据清洗，建立数据质量检查机制 |
| 推荐算法冷启动问题 | 采用混合推荐策略，新用户使用热门推荐兜底 |
| 关联规则挖掘的稀疏性问题 | 动态调整FPGrowth的最小支持度阈值 |
| 聚类数量K值的确定 | 使用轮廓系数评估，自动选择最佳K值 |
| 预测模型的数据泄露问题 | 严格划分训练集和测试集的时间窗口 |

---

## 三、设计或论文方案

### （一）技术方案

#### 1. 系统架构设计

```
┌─────────────────────────────────────────────────────────────┐
│                      用户访问层                              │
│              Vue 3 + Element Plus + ECharts                 │
└─────────────────────────────────────────────────────────────┘
                              │
┌─────────────────────────────────────────────────────────────┐
│                      应用服务层                              │
│         Spring Boot 2.7 + MyBatis-Plus + JWT                │
└─────────────────────────────────────────────────────────────┘
                              │
┌─────────────────────────────────────────────────────────────┐
│                      业务数据层                              │
│                    MySQL 8.0（29张表）                       │
└─────────────────────────────────────────────────────────────┘
                              │
┌─────────────────────────────────────────────────────────────┐
│                     大数据处理层                             │
│    HDFS 3.3.6 + Hive 3.1.2 + Spark 3.5.6 + PySpark         │
│              数据仓库：ODS → DWD → DWS → ADS                │
└─────────────────────────────────────────────────────────────┘
```

#### 2. 技术选型

| 层次 | 技术栈 | 版本 |
|------|--------|------|
| 前端框架 | Vue 3 + Vite | 3.3.4 / 4.5.0 |
| UI组件库 | Element Plus | 2.3.14 |
| 图表库 | ECharts | 5.4.3 |
| 后端框架 | Spring Boot | 2.7.18 |
| ORM框架 | MyBatis-Plus | 3.5.3.1 |
| 分布式存储 | Hadoop HDFS | 3.3.6 |
| 数据仓库 | Apache Hive | 3.1.2 |
| 计算引擎 | Apache Spark | 3.5.6 |
| 机器学习 | Spark MLlib | 3.5.6 |
| 业务数据库 | MySQL | 8.0.33 |

#### 3. 数据处理流程

```
CSV原始数据 → HDFS上传 → ODS层（原始存储）
                              ↓
                    Spark数据清洗（01_data_clean.py）
                              ↓
                    DWD层（维度表 + 事实表）
                              ↓
                    Spark数据汇总（02_data_aggregate.py）
                              ↓
                    DWS层（5张汇总表）
                              ↓
                    Spark数据分析（03_data_analyze.py）
                              ↓
                    ADS层（12张应用表）
                              ↓
                    Spark数据导出（04_data_export.py）
                              ↓
                    MySQL业务数据库（29张表）
                              ↓
                    Spring Boot API服务
                              ↓
                    Vue 3前端展示
```

#### 4. 核心算法设计

**（1）混合推荐算法**
```
最终得分 = CF得分 × 0.5 + 内容得分 × 0.3 + 热门得分 × 0.2
```
- ALS协同过滤：基于用户-图书评分矩阵，使用隐式反馈
- 内容过滤：基于用户历史借阅的主题和作者偏好
- 热门推荐：基于借阅次数和借阅用户数加权计算

**（2）FPGrowth关联规则挖掘**
- 最小支持度：动态计算（至少3个用户借阅过）
- 最小置信度：10%（图书数据稀疏，适当降低阈值）
- 输出：置信度、提升度、支持度、规则描述

**（3）K-means用户聚类**
- 特征：借阅量、活跃天数、逾期率、平均借阅天数、阅读广度
- K值选择：使用轮廓系数评估（测试K=3~7）
- 聚类标签：根据特征自动生成描述性标签

**（4）逾期风险预测（随机森林）**
- 时间划分：前期（6个月前）作为特征，近期（最近6个月）作为标签
- 特征：早期借阅量、活跃天数、平均借阅天数、续借次数、借阅频率
- 输出：逾期概率、风险等级（高/中/低/极低）

### （二）实施方案所需的条件

#### 1. 硬件环境

| 节点 | 角色 | 配置要求 |
|------|------|----------|
| master | NameNode, ResourceManager, Hive Metastore | 8G内存, 4核CPU |
| slave1 | DataNode, NodeManager | 4G内存, 4核CPU |
| slave2 | DataNode, NodeManager | 4G内存, 4核CPU |

#### 2. 软件环境

- 操作系统：CentOS 7 / Ubuntu 20.04
- JDK：1.8+
- Python：3.6+
- Node.js：16+
- Maven：3.6+

#### 3. 数据条件

- 原始数据：高校图书馆借阅记录CSV文件（约10万条记录）
- 数据字段：用户ID、借阅日期、归还日期、图书ID、书名、作者、主题分类、院系、读者类型等22个字段

#### 4. 开发工具

- IDE：IntelliJ IDEA（后端）、VS Code（前端/Spark）
- 数据库工具：Navicat / DataGrip
- 版本控制：Git

---

## 四、主要参考文献目录

[1] 王珊, 萨师煊. 数据库系统概论（第5版）[M]. 北京: 高等教育出版社, 2014.

[2] Kimball R, Ross M. The Data Warehouse Toolkit: The Definitive Guide to Dimensional Modeling (3rd Edition)[M]. Wiley, 2013.

[3] 林子雨. Spark编程基础（Scala版）[M]. 北京: 人民邮电出版社, 2018.

[4] 尚硅谷. Hive数据仓库技术[M]. 北京: 电子工业出版社, 2020.

[5] Leskovec J, Rajaraman A, Ullman J D. Mining of Massive Datasets (3rd Edition)[M]. Cambridge University Press, 2020.

[6] 项亮. 推荐系统实践[M]. 北京: 人民邮电出版社, 2012.

[7] Han J, Kamber M, Pei J. Data Mining: Concepts and Techniques (3rd Edition)[M]. Morgan Kaufmann, 2011.

[8] 周志华. 机器学习[M]. 北京: 清华大学出版社, 2016.

[9] Apache Spark官方文档. https://spark.apache.org/docs/latest/

[10] Apache Hive官方文档. https://hive.apache.org/

[11] Vue.js官方文档. https://vuejs.org/

[12] Spring Boot官方文档. https://spring.io/projects/spring-boot

[13] 张俊林. 大数据日知录：架构与算法[M]. 北京: 电子工业出版社, 2014.

[14] 李航. 统计学习方法（第2版）[M]. 北京: 清华大学出版社, 2019.

[15] 陈明. 高校图书馆大数据分析与应用研究[J]. 图书馆学研究, 2020(15): 45-52.

---

## 五、毕业设计（论文）工作进度计划

| 阶段 | 时间安排 | 主要工作内容 | 预期成果 |
|------|----------|--------------|----------|
| **第一阶段：需求分析与系统设计** | 第1-2周 | 1. 调研高校图书馆数据分析需求<br>2. 分析原始借阅数据结构<br>3. 设计系统架构和数据仓库模型<br>4. 编写需求规格说明书 | 需求规格说明书<br>系统架构设计文档 |
| **第二阶段：环境搭建与数据仓库建设** | 第3-4周 | 1. 搭建Hadoop+Hive+Spark集群环境<br>2. 设计并创建ODS/DWD/DWS/ADS四层表结构<br>3. 开发数据清洗脚本（01_data_clean.py）<br>4. 开发数据汇总脚本（02_data_aggregate.py） | 大数据集群环境<br>数据仓库表结构<br>ETL脚本 |
| **第三阶段：数据分析与挖掘模块开发** | 第5-7周 | 1. 开发数据分析脚本（03_data_analyze.py）<br>2. 开发数据导出脚本（04_data_export.py）<br>3. 开发图书推荐算法（05_book_recommend.py）<br>4. 开发高级数据挖掘（06_advanced_analysis.py）<br>5. 开发预测模型（07_prediction_models.py） | 7个Spark处理脚本<br>29张MySQL业务表 |
| **第四阶段：后端服务开发** | 第8-9周 | 1. 搭建Spring Boot项目框架<br>2. 设计并实现RESTful API接口<br>3. 实现JWT认证和多角色权限控制<br>4. 集成MyBatis-Plus数据访问层<br>5. 编写API接口文档 | 后端服务代码<br>Swagger API文档 |
| **第五阶段：前端界面开发** | 第10-11周 | 1. 搭建Vue 3 + Vite项目框架<br>2. 开发高级管理员功能页面（11个）<br>3. 开发图书管理员功能页面（10个）<br>4. 开发普通用户功能页面（7个）<br>5. 集成ECharts数据可视化 | 前端应用代码<br>28个功能页面 |
| **第六阶段：系统集成与测试** | 第12-13周 | 1. 前后端联调测试<br>2. 数据链路端到端测试<br>3. 性能测试与优化<br>4. 编写部署文档和用户手册 | 完整可运行系统<br>部署文档 |
| **第七阶段：论文撰写与答辩准备** | 第14-16周 | 1. 撰写毕业论文<br>2. 制作答辩PPT<br>3. 准备系统演示<br>4. 论文修改与定稿 | 毕业论文<br>答辩材料 |

### 计算机知识综合应用环节说明

本毕业设计涉及以下计算机专业核心知识的综合应用：

1. **数据库技术：** MySQL关系数据库设计、Hive数据仓库建模、SQL查询优化
2. **分布式计算：** Hadoop HDFS分布式存储、Spark分布式计算框架
3. **数据挖掘与机器学习：** ALS协同过滤、FPGrowth关联规则、K-means聚类、随机森林分类/回归
4. **软件工程：** 需求分析、系统设计、前后端分离架构、RESTful API设计
5. **Web开发：** Vue 3前端框架、Spring Boot后端框架、JWT认证
6. **数据可视化：** ECharts图表库、Dashboard设计

---

**学生签名：** ________________

**日期：** 2025年12月13日

**指导教师意见：**

________________________________________________________________________________

________________________________________________________________________________

**指导教师签名：** ________________

**日期：** ________________
